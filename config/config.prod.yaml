# Production configuration for ekaya-engine
# cp config.yaml.example config.yaml
# Defaults are commented out
# Environment variables override these settings

#
# Server configuration
#

# Port to listen on (environment variable PORT overrides this)
#
# port: "3443"

# Environment name (environment variable ENVIRONMENT overrides this)
#   "local" -- use human-readable logs and report "local" in /health endpoint
#   "anything_else" -- use structured JSON logs and report that value in /health endpoint
#
# env: "local"

#
# Engine Database
#
# Database configuration
# All database connection details should be provided via environment variables
# PGHOST, PGPORT, PGUSER, PGPASSWORD, PGDATABASE, PGTYPE, PGSSLMODE
database:
  max_connections: 50
  max_idle_conns: 10
  type: "postgres"
  ssl_mode: "require"

# Datasource configuration
datasource:
  connection_ttl_minutes: 5      # How long idle connections are kept
  max_connections_per_user: 10   # Limit per user to prevent exhaustion
  pool_max_conns: 10             # Max connections per datasource pool
  pool_min_conns: 1              # Min connections per datasource pool



#
# Setting up HTTPS and custom domains
#

# IMPORTANT:
# OAuth 2.1+ requires HTTPS for domains other than localhost
# You can test on http://localhost:3443 [OKAY]
# You can deploy to external servers https://data.acme.com [OKAY]
# You can deploy to internal domains https://myservice.mydomain:myport [OKAY]
# You cannot deploy to http://data.acme.com [NOT ALLOWED]
# You cannot deploy to http://myservice.mydomain:myport [NOT ALLOWED]
# This means that you will need certificates for TLS:
#
# tls_cert_path: "/path/to/cert.pem"
# tls_key_path: "/path/to/key.pem"
#
# You will also need to set the base_url (or env variable BASE_URL)
# when using HTTPS with a custom domain so that authentication knows where 
# to send users.
# (defaults to http://localhost:$PORT) so you only need to set this if
# you have a custom domain
#
# base_url: "https://myservice.mydomain:myport"

#
# Advanced
#

# Cookie Domain
# Controls which domains can read the authentication cookie.
# Auto-derived from base_url in most cases:
#   localhost/127.0.0.1  → "" (no restriction)
#   *.ekaya.ai           → ".ekaya.ai"
#   *.dev.ekaya.ai       → ".dev.ekaya.ai"
#   other domains        → "" (isolated to hostname)
#
# Only set this if you need cross-subdomain auth on a custom domain.
# Example: api.acme.com and app.acme.com sharing auth → ".acme.com"
# 
# cookie_domain: ""

# Authentication configuration
# You can bring your own authentication system.
# There are a few claims you will need.
# (ex. `pid` ProjectId is how Ekaya Engine supports multitenancy)
#
# auth:
#   enable_verification: true
#   jwks_endpoints: "https://auth.ekaya.ai=https://auth.ekaya.ai/.well-known/jwks.json"



# Optional: Ontology extraction configuration
# Ontology extraction iteration settings
# These control the interactive Q&A loop for ontology extraction
ontology_max_iterations: 3       # Maximum Q&A iterations for ontology extraction (1-20 recommended, default: 1)
ontology_target_confidence: 0.8  # Target confidence threshold 0.0-1.0 (default: 0.8)

# Optional: Tool filters (empty list = all tools enabled)
enabled_tools: []

# Community AI configuration (free models hosted on DGX Spark cluster)
# These are OpenAI-compatible endpoints for the community to use
community_ai:
  llm_base_url: "http://sparkone:30000/v1"
  llm_model: "Qwen3-30B-A3B-NVFP4-self"
  embedding_url: "http://sparkone:30001/v1"
  embedding_model: "Qwen/Qwen3-Embedding-0.6B"

# Embedded AI configuration (licensed models for enterprise deployments)
# Same as community for now, but would be customer-hosted in production
embedded_ai:
  llm_base_url: "http://sparktwo:30000/v1"
  llm_model: "Qwen3-30B-A3B-NVFP4"
  embedding_url: "http://sparktwo:30001/v1"
  embedding_model: "Qwen/Qwen3-Embedding-0.6B"
